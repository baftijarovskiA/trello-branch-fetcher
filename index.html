<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Branch</title>
  </head>
  <body>
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
    <script>
      let ICON =
        "https://cdn.glitch.me/us-east-1%3A3d31b21c-01a0-4da2-8827-4bc6e88b7618%2Ficon-gray.svg";

      let buttonCallback = function (t, opts) {
        let retrieveBranchName = function (t, opts) {
          let cardNumber = 1;
          let projectPrefix = "AB";
          let type = "feature";
          return (
            type +
            "/" +
            projectPrefix +
            "-" +
            cardNumber +
            "-" +
            t.card.name.replaceAll(" ", "-").toLowerCase()
          );
        };

        let BRANCH_NAME = retrieveBranchName(t, opts);

        let onItemClick = function (t, opts) {
          navigator.clipboard.writeText(BRANCH_NAME);
          BRANCH_NAME = "Branch copied!";
        };

        return t.popup({
          title: "Branch Name",
          items: [
            {
              text: BRANCH_NAME,
              callback: onItemClick,
            },
          ],
        });
      };

      window.TrelloPowerUp.initialize({
        "card-buttons": function (t, opts) {
          return [
            {
              icon: ICON,
              text: "Branch 2",
              callback: buttonCallback,
            },
          ];
        },
      });
    </script>
  </body>
</html>
